<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main_layout}">
<head>
<title>결제하기</title>
</head>
<body>
	<div layout:fragment="content">
		<div class="container my-4">
			<div class="row">
				<!-- 왼쪽 입력 영역 -->
				<div class="col-md-8">
					<div class="section-title">결제하기</div>
					<div class="mb-3">
						<label class="form-label">주소</label>
						 <input type="text" name="address1" class="form-control"
						 	th:value="${member != null ? member.address1 : ''}"
							 placeholder="(필수)주소를 입력하세연" />
						<input type="text" class="form-control mt-2" name="address2"
							th:value="${member != null ? member.address2 : ''}"
							placeholder="(필수) 상세주소 입력" />
					</div>
					<div class="mb-3">
						<label class="form-label">휴대전화번호</label> <input type="text"
							id="phone" class="form-control" placeholder="(필수) 휴대전화 번호 입력"
							th:value="${member != null ? member.phone : ''}" />
				
					</div>
					<div class="mb-3">
						<label class="form-label">주문시 요청사항</label>
						<textarea id="orderRequest" class="form-control" rows="3" maxlength="100"
							name="orderRequest" placeholder="예: 배달 시 초인종 누르지 말아주세요."></textarea>
					</div>
					<div class="section-title">결제수단 선택</div>
					<div class="row g-2">
						<div class="col-md-6">
							<button type="button"
							 class="btn btn-outline-secondary w-100" data-method="CARD">신용카드</button>
						</div>
						<div class="col-md-6">
							<button type="button"
							 class="btn btn-outline-secondary w-100" data-method="MOBILE">휴대폰</button>
						</div>
						<div class="col-md-6">
							<button type="button"
							 class="btn btn-outline-success w-100" data-method="NAVERPAY">네이버페이</button>
						</div>
						<div class="col-md-6">
							<button type="button" 
							class="payment-method btn btn-outline-warning w-100" 
							data-method="KAKAO">카카오페이</button>
						</div>
					</div>
					<div class="mt-4">
						<label class="form-label">할인 쿠폰</label>
						<div class="input-group">
							<input type="text" class="form-control" placeholder="쿠폰 코드 입력" />
							<button class="btn btn-outline-danger">적용</button>
						</div>
					</div>
				</div>
				
				<div class="col-12 col-md-4">
				    <div class="card order-summary p-3">
				        <h5 class="card-title mb-3">주문표</h5>

				        <div class="order-item-list mb-3">
				            <div id="emptyOrderMessage"
				                 class="text-muted fst-italic small text-center"
				                 th:classappend="${#lists.isEmpty(orderedItems)} ? '' : 'd-none'">
				                주문한 메뉴가 없습니다.
				            </div>

				            <div th:each="mainItem : ${orderedItems}"
				                 th:if="${mainItem.caPid == null}"
				                 th:data-ca-id="${mainItem.caId}"
				                 class="pb-3 mb-3 border-bottom cart-main-item">

				                <div class="mb-2">
				                    <div class="fw-bold small mb-1"
				                         th:text="|${mainItem.menuName} : ${#numbers.formatInteger(mainItem.totalPrice, 0, 'COMMA')}원|">
				                        메인메뉴명 : 0원
				                    </div>

				                    <div th:each="optItem : ${orderedItems}"
				                         th:if="${optItem.caPid != null and optItem.caPid == mainItem.caId}"
				                         th:data-ca-id="${optItem.caId}"
				                         class="text-muted small ms-3 mb-1 cart-option-item"
				                         th:text="|└ 옵션: ${optItem.optionName} (${#numbers.formatInteger(optItem.totalPrice, 0, 'COMMA')}원)|">
				                        └ 옵션: 옵션명 (0원)
				                    </div>

				                    <!-- +, -, x 버튼 제거 -->
				                </div>
				            </div>
				        </div>

				        <div id="totalOrderPrice" class="mb-2 fw-bold">
				            총 결제 금액: <span th:text="${#numbers.formatInteger(finalTotalPrice, 0, 'COMMA')} + '원'" th:data-price="${finalTotalPrice}"></span>
				        </div>
				        <div id="orderSummaryInfo" class="mb-3"
				             th:classappend="${#lists.isEmpty(orderedItems)} ? 'd-none' : ''">
				            <small class="text-muted d-block mt-1"> (배달비 3,000원 추가) </small>
				        </div>

				        <button class="btn btn-sm w-100 text-white" 
				        		type="button" id="btnPayNow" style="background-color: #43d091;"
				        		disabled>
				            결제하기
				        </button>

				        <div id="guestInfo" th:data-guest-id="${session.guestId}" th:data-user-id="${session.loginId}"></div>
				    </div>
				</div>


			</div>
		</div>
	</div>
	
</body>
</html>
