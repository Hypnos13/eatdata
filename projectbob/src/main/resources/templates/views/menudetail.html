<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main_layout}">
<head>
<meta charset="UTF-8">
<title>ë©”ì¸ í˜ì´ì§€</title>

<!-- Bootstrap CSS -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">

<!-- ì‚¬ìš©ì ì •ì˜ CSS -->
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/main_additional.css">

<!-- Bootstrap Bundle JS -->
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
	<div layout:fragment="content">

		<div class="container mt-4">
			<div class="row">
				<!-- ì™¼ìª½: ë©”ë‰´ ì˜ì—­ -->
				<div class="col-md-8">
				
					<div class="d-flex align-items-center mb-3">
						<img src="https://i.imgur.com/6p4jYkF.png" alt="ë§¥ë„ë‚ ë“œ" width="50" />
						<div class="ms-3">
							<h5 class="mb-0">[[ ${shop.name} ]] - [[ ${shop.address1} ]]</h5>
							<small>â˜… [[${shop.rating}]] / ìµœì†Œì£¼ë¬¸ê¸ˆì•¡ [[${#numbers.formatInteger(shop.minPrice,0,'COMMA')}]]ì›</small>
						</div>
					</div>

					<!-- íƒ­ ë©”ë‰´ -->
					<ul class="nav nav-tabs w-100 justify-content-between">
						<li class="nav-item flex-fill text-center"><a
							class="nav-link active" data-bs-toggle="tab" href="#menu">ë©”ë‰´</a>
						</li>
						<li class="nav-item flex-fill text-center"><a
							class="nav-link" data-bs-toggle="tab" href="#review">í´ë¦°ë¦¬ë·°</a></li>
						<li class="nav-item flex-fill text-center"><a
							class="nav-link" data-bs-toggle="tab" href="#info">ì •ë³´</a></li>
					</ul>

					<div class="tab-content mt-3">
						<!-- ë©”ë‰´ íƒ­ -->
						<div class="tab-pane fade show active" id="menu">
							<div class="row">						
					
							<!-- ë©”ë‰´ ì¹´ë“œ  -->
					<th:block th:if="${not #lists.isEmpty(menuList)}">
					<div class="col-md-6 mb-4" th:each="menu, status: ${menuList}">
									<div class="card text-center p-3 menu-card" 
											th:attr="data-id=${menu.mId},data-name=${menu.name},data-price=${menu.price}">
										<div class="d-flex justify-content-between align-items-center mb-2">
											<span class="menu-title">[[ ${menu.name} ]]</span>
										</div>
										<img src="https://i.imgur.com/Sg4b61a.png" alt="ë©”ë‰´ ì‚¬ì§„"
											class="img-fluid mb-2" />
										<div class="fw-semibold">[[ ${menu.mInfo} ]]</div>
										<div class="menu-price">[[ ${#numbers.formatInteger(menu.price, 0, 'COMMA')} ]]ì›</div>
									</div>
								</div>
					</th:block>
					
					<th:block th:unless="${not #lists.isEmpty(menuList)}">
						<div class="alert alert-info text-center">ë“±ë¡ëœ ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
					</th:block>
				
			
								
							</div>
						</div>

						<!-- ë¦¬ë·° íƒ­ -->
						<div class="tab-pane fade" id="review">
						<!-- ë¦¬ë·° íƒ­ ìƒë‹¨ -->
						<div class="border rounded p-3 mb-3 bg-white">
							<div class="d-flex align-items-center mb-2 justify-content-between" >
								<div class="d-flex align-items-center">
									<span class="fs-4 text-warning me-2">
										<i class="bi bi-star-fill"></i>
									</span>								
											<span class="fs-5">ë³„ì &nbsp; </span>	
								<h2 class="fw-bold me-3" th:text="${#numbers.formatDecimal(reviewAvg, 1, 1)}">4.9</h2>
													
							</div>
							<!-- ì°œë²„íŠ¼ -->
							<div class="d-flex align-items-center">
								<span class="me-1" id="heartCount" th:text="${shop.heart}">0</span>
								<button type="button" id="btnHeart" class="btn btn-outline-danger btn-sm px-2 py-0"
														data-sid="[[${shop.sId}]]">
									<i class="bi bi-heart-fill"></i>
								</button>
							</div>
							</div>
							<div>
								ë¦¬ë·° <span th:text="${reviewList.size()}">0</span>ê°œ
							</div>
						</div>
						<!-- ëŒ“ê¸€ì“°ê¸° -->
						<div class="row my-3">
						<div class="col border p-1 text-center">
						<span id="reviewWrite" class="text-success" style="cursor: pointer;">
							<i class="bi bi-file-earmark-text-fill" style="color: cornflowerblue;"></i>ëŒ“ê¸€ì“°ê¸°
						</span>
						</div>
						</div>
						<!-- ëŒ“ê¸€ í—¤ë” ì˜ì—­ -->						
						<!-- ëŒ“ê¸€ ì“°ê¸° í¼ -->
					<div class="row my-3" id="reviewForm">
						<div class="col">
							<form name="reviewWriteForm" id="reviewWriteForm">
								<input type="hidden" name="sId" th:value="${shop.sId}">
						<!-- 	<input type="hidden" name="id" th:value="${member.id}"> -->
								<div class="row bg-light my-3 p-3 border">
									<div class="col">
										<div class="row">
											<div class="col text-center">
												<span>ë§›ë°¥
												</span>
											</div>
										</div>
										<div class="row my-3">
											<div class="col-md-10">
												<textarea name="reviewContent" id="reviewContent" class="form-control" rows="4"></textarea>												
											</div>
											<div class="col-md">
												<input type="submit" value="ëŒ“ê¸€ì“°ê¸°" class="btn btn-success h-100 w-100" id="reviewWriteButton">
											</div>
										</div>
									</div>
								</div>
							</form>
						</div>
					</div>
						
						<!-- ë¦¬ë·° ë¦¬ìŠ¤íŠ¸ -->
						<div th:if="${not #lists.isEmpty(reviewList)}">
							<div th:each="review : ${reviewList}" class="border-bottom pb-3 mb-3">
								<div class="d-flex align-items-center mb-1">
									<span class="fw-bold" th:text="${#strings.substring(review.id,0,2) + '**ë‹˜'}">ad**ë‹˜</span>
									<span class="text-muted small ms-2" th:text="${#dates.format(review.regDate, 'yyyy-MM-dd')}">ë‚ ì§œ</span>
									<span class="ms-auto text-danger small" style="cursor:pointer">ì‹ ê³ </span>
								</div>
								<!-- ë³„ì   -->
								<div class="mb-1">
									<span class="me-2 text-warning">
										<i class="bi bi-star-fill"></i>										
									</span>
									<span th:text=" ' ' + ${review.rating} +'ì '" class="fw-bold ms-1"></span>
								</div>
								<!-- ë¦¬ë·° ì‚¬ì§„  -->
								<div th:if="${review.rPicture != null}">
									<img th:src="@{'/images/review/' + ${review.rPicture}}" alt="ë¦¬ë·°ì‚¬ì§„" 
													style="max-width:200px;" class="rounded shadow-sm mb-2" />
								</div>
								<!-- ë©”ë‰´ ì„¤ëª… -->
								<div class="text-secondary small mb-1">
									<span th:text="${review.menuName}">ì‹¹ì‹¹ê¹€ì¹˜</span>
								</div>
								<!-- ë¦¬ë·° ë‚´ìš© -->
								<div th:text="${review.content}">good day</div>
							</div>
						</div>
						<!-- ë¦¬ë·° ì—†ì„ë•Œ -->
						<div th:unless="${not #lists.isEmpty(reviewList)}" class="text-center text-muted p-5">
							no ë¦¬ë·°~
						</div>									
					
						</div>

						<!-- ì •ë³´ íƒ­ -->
						<div class="tab-pane fade" id="info">
							<p>
								<strong>ì˜ì—…ì‹œê°„:</strong>[[${shop.opTime}]]<br /> <strong>ìœ„ì¹˜:</strong> <span
									id="storeAddress">[[${shop.address1}]] - [[${shop.address2}]]</span><br /> <strong>ì „í™”:</strong>
								[[${shop.phone}]]
							</p>

							<div class="mt-3">
								<h6>ğŸ“ ìœ„ì¹˜ ì§€ë„</h6>
								<div id="map"
									style="width: 100%; height: 300px; border: 1px solid #ccc; border-radius: 10px;"></div>
							</div>
						</div>
					</div>
				</div>

				<!-- ì£¼ë¬¸í‘œ -->
				<div class="col-md-4">
					<div class="card order-summary p-3">
						<h5 class="card-title">ğŸ›’ ì£¼ë¬¸í‘œ</h5>

						<div class="order-item-list mb-3">
							<!-- ì£¼ë¬¸ ë©”ë‰´ ë° ì¶”ê°€ ë©”ë‰´ê°€ ì—¬ê¸° ë™ì ìœ¼ë¡œ ë“¤ì–´ê°‘ë‹ˆë‹¤ -->
						</div>

						<hr />
						<p>
							ì´ ê°€ê²©: <strong id="totalPrice">0ì›</strong><br /> <small
								class="text-muted">(ë°°ë‹¬ë¹„ í¬í•¨)</small>
						</p>

						<!-- ìˆ˜ëŸ‰ ì¡°ì ˆ ì˜ì—­ -->
						<div class="qty-control d-flex flex-row align-items-center mb-3">
							<button class="btn btn-outline-secondary btn-qty"
								onclick="minus()">âˆ’</button>
							<span id="itemCount" class="mx-3">0</span>
							<button class="btn btn-outline-secondary btn-qty"
								onclick="plus()">ï¼‹</button>
						</div>

						<!-- ì£¼ë¬¸ ì´ˆê¸°í™”(ì‚­ì œ) ë²„íŠ¼ -->
						<button class="btn btn-danger w-100 mb-2" id="btnRemoveItem">ì£¼ë¬¸
							ì·¨ì†Œ</button>

						<button class="btn text-white w-100"
							style="background-color: #43d091;" id="btnOrderNow">
							ì£¼ë¬¸í•˜ê¸°</button>
					</div>
				</div>


			</div>
		</div>

<form id="orderForm" method="post" action="/pay" style="display:none">
	<input type="hidden" name="menuId" id="orderMenuId">
	<input type="hidden" name="count" id="orderCount">
	<input type="hidden" name="optionIds" id="orderOptionIds">
	<input type="hidden" name="totalPrice" id="orderTotalPrice">
</form>

	</div>




<script src="/js/main.js"></script>
</body>
</html>
