<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/shop_layout}">
  <div layout:fragment="content">
    <div class="container py-3">
      <h4>🔔 신규 주문</h4>
      <ul id="newOrderList" class="list-group" th:data-shop-id="${currentShop.sId}">
        <li th:each="o : ${orders}" class="list-group-item mb-3 p-3">
          <div class="d-flex justify-content-between">
            <div>
              <div><strong>주문번호:</strong> <span th:text="${o.oNo}"/></div>
              <!-- ... -->
              <div class="small text-muted d-flex align-items-center">
                <i class="bi bi-clock me-1"></i>
                <span th:text="${#dates.format(o.regDate,'HH:mm')}"/>
                <span class="ms-3 text-danger d-flex align-items-center">
                  <i class="bi bi-hourglass-bottom me-1"></i>
                  <span id="countdown-[[${o.oNo}]]"
                        class="timer"
                        th:attr="data-expiry=${o.regDate.time + 180000}">--:--</span>
                </span>
              </div>
              <div class="progress mt-1" style="height:6px;">
                <div id="progress-countdown-[[${o.oNo}]]"
                     class="progress-bar bg-danger progress-bar-striped"
                     role="progressbar"
                     style="width:100%"></div>
              </div>
            </div>
            <button class="btn btn-outline-info btn-sm"
                    th:onclick="|acceptOrder(${o.oNo})|">확인</button>
          </div>

            <!-- 상세정보 -->
            <div class="order-detail" th:id="'detail-' + ${o.oNo}">
              <hr>
              <div><strong>수량:</strong> <span th:text="${o.quantity} + '개'"></span></div>
              <div><strong>요청사항:</strong> <span th:text="${o.request ?: '요청사항 없음'}"></span></div>
              <div class="mt-3">
                <button type="button" class="btn btn-success btn-sm me-2" th:onclick="|acceptOrder(${o.oNo})|">수량</button>
                <button type="button" class="btn btn-outline-danger btn-sm" th:onclick="|rejectOrder(${o.oNo})|">거절</button>
              </div>
            </div>
          </li>

          <li th:if="${#lists.isEmpty(orders)}"
            class="list-group-item text-center text-muted">
          대기 중인 주문이 없습니다.
        </li>
      </ul>
    </div>
  </div>
</html>
