<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/shop_layout}">
<head>
  <title>ì£¼ë¬¸ë‚´ì—­</title>
  <style>
  .pagination .page-link {
    color: #198754;
  }
	
  .pagination .page-item.active .page-link {
    background-color: #198754;
    border-color: #198754;
    color: white;
  }
  </style>
</head>
<body>
  <div layout:fragment="content">
  	<div class="content-panel">
    <!-- íƒ€ì´í‹€ + í˜ì´ì§€ë‹¹ ê°œìˆ˜ ì„ íƒì„ ê°™ì€ ì¤„ì— -->
	<div class="d-flex justify-content-between align-items-center mb-3">
	  <h3 class="mb-0">ğŸ“¦ ì£¼ë¬¸ë‚´ì—­</h3>
	  
	  <form id="pageSizeForm" th:action="@{/shop/orders}" method="get" class="d-flex">
	    <!-- s_id ìœ ì§€ -->
	    <input type="hidden" name="s_id" th:value="${currentShop != null ? currentShop.sId : sId}" />
	    <!-- ì‚¬ì´ì¦ˆ ë³€ê²½ ì‹œ 1í˜ì´ì§€ë¡œ -->
	    <input type="hidden" name="page" value="1" />
	    <label class="me-2 mb-0">ê°œìˆ˜:</label>
	    <select name="size" class="form-select w-auto" onchange="this.form.submit()">
	      <option th:value="10" th:selected="${pageSize==10}">10ê°œ</option>
	      <option th:value="20" th:selected="${pageSize==20}">20ê°œ</option>
	      <option th:value="30" th:selected="${pageSize==30}">30ê°œ</option>
	    </select>
	  </form>
	</div>

    <table class="table">
      <thead>
        <tr>
          <th>ì£¼ë¬¸ë²ˆí˜¸</th>
          <th>ì£¼ë¬¸ì¼ì‹œ</th>
          <th>ì´ê¸ˆì•¡</th>
          <th>ìƒíƒœ</th>
          <th>ìƒì„¸ë³´ê¸°</th>
        </tr>
      </thead>
      <tbody>
        <!-- ì£¼ë¬¸ì´ ìˆì„ ë•Œ -->
		<tr th:each="order : ${orders}" data-order-no="${order.oNo}">
          <!-- ì£¼ë¬¸ë²ˆí˜¸ -->
		  <td th:text="${order.oNo}">123</td>
          <!-- ì£¼ë¬¸ì¼ì‹œ -->
		  <td th:text="${#dates.format(order.regDate,'yyyy-MM-dd HH:mm')}">2025-08-02 14:03</td>
          <!-- ì´ê¸ˆì•¡ -->
		  <td th:text="${#numbers.formatInteger(order.totalPrice,0,'COMMA')} + 'ì›'">11,000ì›</td>
          <!-- ìƒíƒœ -->
		  <td class="status-cell" th:text="${order.status}">REJECTED</td>
          <!-- ìƒì„¸ë³´ê¸° ë²„íŠ¼ -->
		  <td>
            <a th:href="@{|/shop/orderDetail?oNo=${order.oNo}|}"
               class="btn btn-sm btn-outline-success">ë³´ê¸°</a>
          </td>
        </tr>
        <!-- ì£¼ë¬¸ì´ ì—†ì„ ë•Œ -->
		<tr th:if="${#lists.isEmpty(orders)}">
	      <td colspan="5" class="text-center text-muted">
	        ì£¼ë¬¸ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.
	      </td>
	    </tr>
      </tbody>
    </table>
    
    <!-- í˜ì´ì§€ë„¤ì´ì…˜ (ë¦¬ë·°ì™€ ë™ì¼ êµ¬ì¡°) -->
      <nav aria-label="Page navigation" th:if="${totalPages != null and totalPages > 0}">
        <ul class="pagination justify-content-center">
          <!-- ì´ì „ ê·¸ë£¹ -->
          <li class="page-item" th:classappend="${startPageGroup>1} ? '' : 'disabled'">
            <a class="page-link"
               th:href="@{/shop/orders(
                 s_id=${currentShop != null ? currentShop.sId : sId},
                 page=${startPageGroup-1},
                 size=${pageSize}
               )}">Â«</a>
          </li>

          <!-- í˜ì´ì§€ ë²ˆí˜¸ë“¤ -->
          <li class="page-item"
              th:each="i : ${#numbers.sequence(startPageGroup, endPageGroup)}"
              th:classappend="${i==currentPage} ? 'active'">
            <a class="page-link"
               th:href="@{/shop/orders(
                 s_id=${currentShop != null ? currentShop.sId : sId},
                 page=${i},
                 size=${pageSize}
               )}"
               th:text="${i}">1</a>
          </li>

          <!-- ë‹¤ìŒ ê·¸ë£¹ -->
          <li class="page-item" th:classappend="${endPageGroup<totalPages} ? '' : 'disabled'">
            <a class="page-link"
               th:href="@{/shop/orders(
                 s_id=${currentShop != null ? currentShop.sId : sId},
                 page=${endPageGroup+1},
                 size=${pageSize}
               )}">Â»</a>
          </li>
        </ul>
      </nav>
    
  </div>
</div>
  <!-- ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ (layoutì—ì„œ ì´ë¯¸ shop.jsë¥¼ í¬í•¨í•˜ê³  ìˆì§€ ì•Šë‹¤ë©´ ì¶”ê°€í•˜ì„¸ìš”) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
  <script th:src="@{/js/shop.js}"></script>
</body>
</html>
