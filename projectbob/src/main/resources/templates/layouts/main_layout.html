<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<meta charset="UTF-8">
<title>구조</title>
<link th:href="@{/bootstrap/bootstrap.min.css}" rel="stylesheet">
<link th:href="@{/css/main.css}" rel="stylesheet" />
<script th:src="@{/js/jquery-3.7.1.min.js}"></script>

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">


<!-- window.currentUserId 주입 코드 추가 -->
<script th:inline="javascript">
	// Thymeleaf를 사용하여 세션에서 로그인 ID를 가져와 window.currentUserId에 할당
	// 값이 문자열이면 자동으로 따옴표로 묶이고, null이면 JavaScript의 null 키워드로 렌더링됩니다.
	window.currentUserId = /*[[${session.loginId}]]*/null;

	// 디버깅을 위해 콘솔에 출력
	console.log("Current User ID (from main_layout):", window.currentUserId);
</script>


<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
	rel="stylesheet">

</head>
<body>
	<div th:replace="~{fragments/header::header}"></div>
	<div class="container">
		<div layout:fragment="content"></div>
	</div>
	<div th:replace="~{fragments/footer::footer}"></div>


	<script th:src="@{js/main.js}"></script>
	<script src="https://cdn.portone.io/v2/browser-sdk.js" async defer></script>


	<!-- 추가 메뉴 선택 모달 -->
	<div class="modal fade" id="addMenuModal" tabindex="-1"
		aria-labelledby="addMenuModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">

				<!-- 모달 헤더 -->
				<div class="modal-header">
					<h5 class="modal-title" id="addMenuModalLabel">추가 메뉴 선택</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"
						aria-label="닫기"></button>
				</div>

				<!-- 모달 본문 -->
				<div class="modal-body">
					<div class="row">

						<!-- 메뉴 이미지 영역 -->
						<div class="col-md-4 text-center">
							<img id="modalMenuImage" src="" alt="메뉴 이미지"
								class="img-fluid rounded"
								style="max-height: 200px; object-fit: contain;">
						</div>

						<!-- 메뉴 정보 및 옵션 영역 -->
						<div class="col-md-8">
							<h4 id="modalMenuName" class="fw-bold mb-1"></h4>
							<p id="modalMenuInfo" class="text-muted"></p>
							<div id="modalMenuPrice" class="text-primary fw-semibold mb-2"></div>

							<!-- 숨은 필드 -->
							<input type="hidden" id="hiddenMenuPrice"> <input
								type="hidden" id="hiddenGuestId" value="">

							<hr>

							<!-- 추가 옵션 선택 -->
							<h6>추가 선택 옵션</h6>
							<div id="optionArea" class="mb-3">
						
							</div>

							<!-- 수량 조절 -->
							<div class="d-flex align-items-center mt-3">
								<label for="modalCount" class="me-3 fw-semibold"
									style="min-width: 50px;">수량</label>
								<button type="button" class="btn btn-outline-secondary btn-sm"
									id="btnCountMinus">-</button>
								<input type="text" id="modalCount" value="1" readonly
									class="form-control form-control-sm text-center mx-2"
									style="width: 60px;">
								<button type="button" class="btn btn-outline-secondary btn-sm"
									id="btnCountPlus">+</button>
							</div>

							<hr>
							<!-- 여기 라인 추가 -->

					<div id="nutritionInfo" class="mt-3">
    <h5>영양 성분</h5>

    <!-- 여기에 div.table-responsive 추가 -->
    <div class="table-responsive">
        <table class="table table-bordered text-center align-middle">
            <thead class="table-light">
                <tr>
                    <th>열량 (kcal)</th>
                    <th>탄수화물 (g)</th>
                    <th>단백질 (g)</th>
                    <th>지방 (g)</th>
                    <th>포화지방 (g)</th>
                    <th>당 (g)</th>
                    <th>나트륨 (mg)</th>
                    <th>제공량 (g)</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="entry : ${menuCalMap}"
                    th:attr="data-mid=${entry.key}"
                    class="d-none">
                    <td th:text="${entry.value.calories}">-</td>
                    <td th:text="${entry.value.carbs}">-</td>
                    <td th:text="${entry.value.protein}">-</td>
                    <td th:text="${entry.value.fat}">-</td>
                    <td th:text="${entry.value.sfa}">-</td>
                    <td th:text="${entry.value.sugar}">-</td>
                    <td th:text="${entry.value.sodium}">-</td>
                    <td th:text="${entry.value.servingSize}">-</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

						</div>
					</div>
				</div>

				<!-- 모달 푸터 -->
				<div class="modal-footer">

					<button type="button" id="btnAddExtras" class="btn btn-primary">장바구니에
						추가</button>
				</div>

			</div>
		</div>
	</div>



	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

	<script
		src="//dapi.kakao.com/v2/maps/sdk.js?appkey=30a0d7b80b66b1135d1195c80899795d&libraries=services"></script>

	<script th:src="@{js/main.js}"></script>
</body>
</html>


